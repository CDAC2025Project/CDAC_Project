/*
 * bmp.h
 *
 *  Created on: Nov 26, 2025
 *      Author: sunbeam
 */


 #ifndef BMP_H_
#define BMP_H_

#include "stm32f4xx.h"
#include "i2c.h"

// BMP280 I2C address
#define BMP280_ADDR 0x76  // if SDO tied to VCC use 0x77

// BMP280 registers
#define BMP280_REG_ID          0xD0
#define BMP280_REG_RESET       0xE0
#define BMP280_REG_CTRL_MEAS   0xF4
#define BMP280_REG_CONFIG      0xF5
#define BMP280_REG_PRESS_MSB   0xF7
#define BMP280_REG_PRESS_LSB   0xF8
#define BMP280_REG_PRESS_XLSB  0xF9

// Calibration registers
#define BMP280_REG_CALIB_START 0x88

// Structure to hold calibration data
typedef struct {
    uint16_t dig_P1;
    int16_t  dig_P2;
    int16_t  dig_P3;
    int16_t  dig_P4;
    int16_t  dig_P5;
    int16_t  dig_P6;
    int16_t  dig_P7;
    int16_t  dig_P8;
    int16_t  dig_P9;
} BMP280_Calib;

extern BMP280_Calib bmp280_calib;
extern int32_t t_fine;

uint8_t BMP280_Init(void);
int32_t BMP280_ReadPressure(void);

#endif
